var documenterSearchIndex = {"docs":
[{"location":"orbitals/#Orbitals-and-quantum-systems-1","page":"Orbitals","title":"Orbitals and quantum systems","text":"","category":"section"},{"location":"orbitals/#","page":"Orbitals","title":"Orbitals","text":"When calculating matrix elements of tensor components (using the The Wigner–Eckart theorem), it is important to know which part of the quantum system the tensor acts on, e.g. tensorC and tensornabla act on the spatial part of a spin-orbital (the coordinates r, theta, and phi, or equivalently, the quantum numbers n, ell, m_ell), whereas tensorS acts on the spin part (the coordinate s, or equivalently, the quantum numbers s and m_s).","category":"page"},{"location":"orbitals/#","page":"Orbitals","title":"Orbitals","text":"AngularMomentumAlgebra.System\nAngularMomentumAlgebra.SubSystem\nAngularMomentumAlgebra.FullSystem\nAngularMomentumAlgebra.SpatialSubSystem\nAngularMomentumAlgebra.OrbitalAngularMomentumSubSystem\nAngularMomentumAlgebra.SpinSubSystem\nAngularMomentumAlgebra.TotalAngularMomentumSubSystem","category":"page"},{"location":"orbitals/#AngularMomentumAlgebra.System","page":"Orbitals","title":"AngularMomentumAlgebra.System","text":"System\n\nThe abstract base type for a (quantum) system.\n\n\n\n\n\n","category":"type"},{"location":"orbitals/#AngularMomentumAlgebra.SubSystem","page":"Orbitals","title":"AngularMomentumAlgebra.SubSystem","text":"SubSystem{which}\n\nA subsystem, i.e. limited to a set of coordinates.\n\n\n\n\n\n","category":"type"},{"location":"orbitals/#AngularMomentumAlgebra.FullSystem","page":"Orbitals","title":"AngularMomentumAlgebra.FullSystem","text":"FullSystem\n\nThe entire system, i.e. all coordinates.\n\n\n\n\n\n","category":"type"},{"location":"orbitals/#AngularMomentumAlgebra.SpatialSubSystem","page":"Orbitals","title":"AngularMomentumAlgebra.SpatialSubSystem","text":"SpatialSubSystem\n\nThe spatial subsystem, i.e. the coordinates r, θ, and ϕ.\n\n\n\n\n\n","category":"type"},{"location":"orbitals/#AngularMomentumAlgebra.OrbitalAngularMomentumSubSystem","page":"Orbitals","title":"AngularMomentumAlgebra.OrbitalAngularMomentumSubSystem","text":"OrbitalAngularMomentaSubSystem\n\nThe orbital angular momentum subsystem, i.e. the coordinates, θ and ϕ.\n\n\n\n\n\n","category":"type"},{"location":"orbitals/#AngularMomentumAlgebra.SpinSubSystem","page":"Orbitals","title":"AngularMomentumAlgebra.SpinSubSystem","text":"SpinSubSystem\n\nThe spin subsystem, i.e. the coordinate s.\n\n\n\n\n\n","category":"type"},{"location":"orbitals/#AngularMomentumAlgebra.TotalAngularMomentumSubSystem","page":"Orbitals","title":"AngularMomentumAlgebra.TotalAngularMomentumSubSystem","text":"TotalAngularMomentumSubSystem\n\nThe total angular momentum subsystem, i.e. the coordinates, θ, ϕ, and s.\n\n\n\n\n\n","category":"type"},{"location":"orbitals/#","page":"Orbitals","title":"Orbitals","text":"Given the different systems and subsystems listed above, it is interesting to access the quantum numbers of an orbital pertaining to these. For this, quantum_numbers(::System, ::SpinOrbital) is provided, which returns Pairs of (magnitudes,) => projection, where projection is either a Number or missing if it is not a good quantum number, e.g. m_ell being the projection quantum number for both AngularMomentumAlgebra.SpatialSubSystem and AngularMomentumAlgebra.OrbitalAngularMomentumSubSystem is not a good quantum number for coupled spin-orbitals (ketn ell j m_j).","category":"page"},{"location":"orbitals/#","page":"Orbitals","title":"Orbitals","text":"julia> using AngularMomentumAlgebra, AtomicLevels, HalfIntegers\n\njulia> o = SpinOrbital(o\"3d\", 1, -half(1))\n3d₁β\n\njulia> ro = SpinOrbital(ro\"3d\", half(1))\n3d(1/2)\n\njulia> quantum_numbers(FullSystem(), o)\n((3, 2) => 1, 1/2 => -1/2)\n\njulia> quantum_numbers(FullSystem(), ro)\n(3, 2, 1/2, 5/2) => 1/2\n\njulia> quantum_numbers(SpatialSubSystem(), o)\n(3, 2) => 1\n\njulia> quantum_numbers(SpatialSubSystem(), ro)\n(3, 2) => missing\n\njulia> quantum_numbers(OrbitalAngularMomentumSubSystem(), o)\n2 => 1\n\njulia> quantum_numbers(OrbitalAngularMomentumSubSystem(), ro)\n2 => missing\n\njulia> quantum_numbers(SpinSubSystem(), o)\n1/2 => -1/2\n\njulia> quantum_numbers(SpinSubSystem(), ro)\n1/2 => missing\n\njulia> quantum_numbers(TotalAngularMomentumSubSystem(), o)\n(2, 1/2, missing) => 1/2\n\njulia> quantum_numbers(TotalAngularMomentumSubSystem(), ro)\n(2, 1/2, 5/2) => 1/2","category":"page"},{"location":"orbitals/#","page":"Orbitals","title":"Orbitals","text":"AngularMomentumAlgebra.quantum_numbers","category":"page"},{"location":"orbitals/#AngularMomentumAlgebra.quantum_numbers","page":"Orbitals","title":"AngularMomentumAlgebra.quantum_numbers","text":"quantum_numbers(::FullSystem, o::SpinOrbital{<:Orbital})\n\nThe full system of an uncoupled spin-orbital is nell m_ell s m_s, where  denotes that the spatial and spin subsystems are separable.\n\n\n\n\n\nquantum_numbers(::FullSystem, o::SpinOrbital{<:RelativisticOrbital})\n\nThe full system of a coupled spin-orbital is nell s j m_j.\n\n\n\n\n\nquantum_numbers(::SpatialSubSystem, o::SpinOrbital{<:Orbital})\n\nThe spatial subsystem of an uncoupled spin-orbital is nell m_ell.\n\n\n\n\n\nquantum_numbers(::SpatialSubSystem, o::SpinOrbital{<:RelativisticOrbital})\n\nThe spatial subsystem of a coupled spin-orbital is just nell m_ell; m_ell is not a good quantum number.\n\n\n\n\n\nquantum_numbers(::OrbitalAngularMomentumSubSystem, o::SpinOrbital{<:Orbital})\n\nThe orbital angular momentum subsystem of an uncoupled spin-orbital is ell m_ell.\n\n\n\n\n\nquantum_numbers(::OrbitalAngularMomentumSubSystem, o::SpinOrbital{<:RelativisticOrbital})\n\nThe orbital angular momentum subsystem of a coupled spin-orbital is just ell; m_ell is not a good quantum number.\n\n\n\n\n\nquantum_numbers(::SpinSubSystem, o::SpinOrbital{<:Orbital})\n\nThe spin subsystem of an uncoupled spin-orbital is s m_s.\n\n\n\n\n\nquantum_numbers(::SpinSubSystem, o::SpinOrbital{<:RelativisticOrbital})\n\nThe spin subsystem of a coupled spin-orbital is just s; m_s is not a good quantum number.\n\n\n\n\n\nquantum_numbers(::TotalAngularMomentumSubSystem, o::SpinOrbital{<:Orbital})\n\nThe total angular momentum of an uncoupled spin-orbital is not a good quantum number; only its projection is known.\n\n\n\n\n\nquantum_numbers(::TotalAngularMomentumSubSystem, o::SpinOrbital{<:RelativisticOrbital})\n\nThe total angular momentum subsystem of a coupled spin-orbital just ell s j m_j.\n\n\n\n\n\n","category":"function"},{"location":"angular_momenta/#Angular-Momenta-1","page":"Angular momenta","title":"Angular Momenta","text":"","category":"section"},{"location":"angular_momenta/#orbital_angular_momentum-1","page":"Angular momenta","title":"Orbital angular momentum","text":"","category":"section"},{"location":"angular_momenta/#","page":"Angular momenta","title":"Angular momenta","text":"OrbitalAngularMomentum\nrme(ℓ′, ::OrbitalAngularMomentum, ℓ)","category":"page"},{"location":"angular_momenta/#AngularMomentumAlgebra.OrbitalAngularMomentum","page":"Angular momenta","title":"AngularMomentumAlgebra.OrbitalAngularMomentum","text":"OrbitalAngularMomentum()\n\nThe angular momentum tensorL is associated with the spatial coordinates theta and phi.\n\n\n\n\n\n","category":"type"},{"location":"angular_momenta/#AngularMomentumAlgebra.rme-Tuple{Any,OrbitalAngularMomentum,Any}","page":"Angular momenta","title":"AngularMomentumAlgebra.rme","text":"rme(ℓ′, 𝐋̂, ℓ)\n\nCalculate the reduced matrix element of the orbital angular momentum:\n\nbeginequation\ntagV13267\nredmatrixelelltensorLell defd\ndelta_ellellsqrtell(ell+1)(2ell+1)\nendequation\n\nExamples\n\njulia> rme(1, OrbitalAngularMomentum(), 1)\n2.449489742783178\n\njulia> rme(1, OrbitalAngularMomentum(), 2)\n0\n\n\n\n\n\n","category":"method"},{"location":"angular_momenta/#spin_angular_momentum-1","page":"Angular momenta","title":"Spin angular momentum","text":"","category":"section"},{"location":"angular_momenta/#","page":"Angular momenta","title":"Angular momenta","text":"SpinAngularMomentum\nrme(s′, ::SpinAngularMomentum, s)","category":"page"},{"location":"angular_momenta/#AngularMomentumAlgebra.SpinAngularMomentum","page":"Angular momenta","title":"AngularMomentumAlgebra.SpinAngularMomentum","text":"SpinAngularMomentum()\n\nThe spin angular momentum tensorS is the intrinsic angular momentum associated with the coordinate s.\n\n\n\n\n\n","category":"type"},{"location":"angular_momenta/#AngularMomentumAlgebra.rme-Tuple{Any,SpinAngularMomentum,Any}","page":"Angular momenta","title":"AngularMomentumAlgebra.rme","text":"rme(s′, ::SpinAngularMomentum, s)\n\nCalculate the reduced matrix element of the spin angular momentum:\n\nbeginequation\ntagV13295\nredmatrixelstensorSs defd\ndelta_ss\nsqrts(s+1)(2s+1)\nendequation\n\nExamples\n\njulia> rme(half(1), SpinAngularMomentum(), half(1))\n1.224744871391589\n\njulia> rme(half(1), SpinAngularMomentum(), half(3))\n0\n\n\n\n\n\n","category":"method"},{"location":"angular_momenta/#total_angular_momentum-1","page":"Angular momenta","title":"Total angular momentum","text":"","category":"section"},{"location":"angular_momenta/#","page":"Angular momenta","title":"Angular momenta","text":"TotalAngularMomentum\nrme((ℓ′,s′,J′)::Tuple{<:Number, <:Number, <:Number}, ::TotalAngularMomentum, (ℓ,s,J)::Tuple{<:Number, <:Number, <:Number})","category":"page"},{"location":"angular_momenta/#AngularMomentumAlgebra.TotalAngularMomentum","page":"Angular momenta","title":"AngularMomentumAlgebra.TotalAngularMomentum","text":"TotalAngularMomentum()\n\nThe total angular momentum tensorJ = tensorL + tensorS results from the coupling of the orbital and spin angular momenta.\n\n\n\n\n\n","category":"type"},{"location":"angular_momenta/#AngularMomentumAlgebra.rme-Tuple{Tuple{#s3,#s1,#s4} where #s4<:Number where #s1<:Number where #s3<:Number,TotalAngularMomentum,Tuple{#s5,#s6,#s7} where #s7<:Number where #s6<:Number where #s5<:Number}","page":"Angular momenta","title":"AngularMomentumAlgebra.rme","text":"rme((ℓ′,s′,J′), ::TotalAngularMomentum, (ℓ,s,J))\n\nCalculate the reduced matrix element of the total angular momentum:\n\nbeginequation\ntagV13238\nredmatrixelellsJtensorJell s J defd\ndelta_ellelldelta_ssdelta_JJ\nsqrtJ(J+1)(2J+1)\nendequation\n\nExamples\n\njulia> rme((1,half(1),half(3)), TotalAngularMomentum(), (1,half(1),half(3)))\n3.872983346207417\n\njulia> rme((1,half(1),half(3)), TotalAngularMomentum(), (1,half(1),half(1)))\n0\n\n\n\n\n\n","category":"method"},{"location":"coulomb/#Coulomb-interaction-1","page":"Coulomb interaction","title":"Coulomb interaction","text":"","category":"section"},{"location":"coulomb/#","page":"Coulomb interaction","title":"Coulomb interaction","text":"DocTestSetup = quote\n    using AngularMomentumAlgebra\n    using AtomicLevels\nend","category":"page"},{"location":"coulomb/#","page":"Coulomb interaction","title":"Coulomb interaction","text":"The Coulomb interaction between two electrons at coordinates 1 and 2, respectively, can in spherical coordinates be multipole-expanded as:","category":"page"},{"location":"coulomb/#","page":"Coulomb interaction","title":"Coulomb interaction","text":"beginequation\nfrac1r_12 =\nsum_k=0^infty\nfracr_^kr_^k+1\nP_k(costheta)\nendequation","category":"page"},{"location":"coulomb/#","page":"Coulomb interaction","title":"Coulomb interaction","text":"which by the addition theorem for the spherical harmonics can be further expanded as","category":"page"},{"location":"coulomb/#","page":"Coulomb interaction","title":"Coulomb interaction","text":"beginequation\nfrac1r_12 =\nsum_kq\nfrac4pi2k+1\nfracr_^kr_^k+1\nconjY^k_q(1)Y^k_q(2)equiv\nsum_kq\nfracr_^kr_^k+1\ntensorC^k_q(1)cdottensorC^k_q(2)\ntagV5179\nendequation","category":"page"},{"location":"coulomb/#","page":"Coulomb interaction","title":"Coulomb interaction","text":"where we in the last step have used the definition of the Spherical tensors.","category":"page"},{"location":"coulomb/#","page":"Coulomb interaction","title":"Coulomb interaction","text":"CoulombInteractionMultipole\nCoulombPotentialMultipole","category":"page"},{"location":"coulomb/#AngularMomentumAlgebra.CoulombInteractionMultipole","page":"Coulomb interaction","title":"AngularMomentumAlgebra.CoulombInteractionMultipole","text":"CoulombInteractionMultipole(k, g)\n\nRepresents the kth multipole of the multipole expansion of the Coulomb interaction g.\n\n\n\n\n\n","category":"type"},{"location":"coulomb/#AngularMomentumAlgebra.CoulombPotentialMultipole","page":"Coulomb interaction","title":"AngularMomentumAlgebra.CoulombPotentialMultipole","text":"CoulombPotentialMultipole\n\nType alias for contraction of the CoulombInteractionMultipole over one coordinate, thereby forming a potential in the other coordinate.\n\n\n\n\n\n","category":"type"},{"location":"coulomb/#","page":"Coulomb interaction","title":"Coulomb interaction","text":" DocTestSetup = nothing","category":"page"},{"location":"common/#Common-routines-1","page":"Common routines","title":"Common routines","text":"","category":"section"},{"location":"common/#","page":"Common routines","title":"Common routines","text":"CurrentModule = AngularMomentumAlgebra\nDocTestSetup = quote\n    using AngularMomentumAlgebra\n    using AtomicLevels\nend","category":"page"},{"location":"common/#","page":"Common routines","title":"Common routines","text":"∏\ntriangle_range\npowneg1\njmⱼ\nspin\nLinearCombination\n@linearly_combinable\nclebsch_gordan_condon_shortley\nAngularMomentumAlgebra.@δ","category":"page"},{"location":"common/#AngularMomentumAlgebra.∏","page":"Common routines","title":"AngularMomentumAlgebra.∏","text":"∏(ℓs...)\n\nCalculates √((2ℓ₁+1)(2ℓ₂+1)...(2ℓₙ+1)), which is a common factor in angular momentum algebra.\n\n\n\n\n\n","category":"function"},{"location":"common/#AngularMomentumAlgebra.triangle_range","page":"Common routines","title":"AngularMomentumAlgebra.triangle_range","text":"triangle_range(a,b)\n\nFind all (even) k such that |a-b| ≤ k ≤ a + b. This is useful when expanding matrix elements of tensors between angular momenta a and b in multipoles k; triangle_range can then be used to decided which multipole terms are required.\n\n\n\n\n\n","category":"function"},{"location":"common/#AngularMomentumAlgebra.powneg1","page":"Common routines","title":"AngularMomentumAlgebra.powneg1","text":"powneg1(k) = (-)ᵏ\n\nCalculates powers of negative unity for integer k.\n\n\n\n\n\n","category":"function"},{"location":"common/#AngularMomentumAlgebra.jmⱼ","page":"Common routines","title":"AngularMomentumAlgebra.jmⱼ","text":"jmⱼ(o::SpinOrbital)\n\nReturn the angular momentum and its projection on the z axis of the spin-orbital o.\n\n\n\n\n\n","category":"function"},{"location":"common/#AngularMomentumAlgebra.spin","page":"Common routines","title":"AngularMomentumAlgebra.spin","text":"spin(o::SpinOrbital)\n\nReturn the spin of the spin-orbital o.\n\n\n\n\n\n","category":"function"},{"location":"common/#AngularMomentumAlgebra.LinearCombination","page":"Common routines","title":"AngularMomentumAlgebra.LinearCombination","text":"LinearCombination(Ts::Vector{T}, coeffs::Vector{N})\n\nRepresents a general linear combination of objects of type T.\n\n\n\n\n\n","category":"type"},{"location":"common/#AngularMomentumAlgebra.@linearly_combinable","page":"Common routines","title":"AngularMomentumAlgebra.@linearly_combinable","text":"@linearly_combinable TT\n\nTurns the type TT into a linearly combinable type, i.e. defines arithmetic operators.\n\nExamples\n\njulia> @linearly_combinable Symbol\n\njulia> 4*(:x) - 5*(:y)\n4 :x - 5 :y\n\n\n\n\n\n","category":"macro"},{"location":"common/#AngularMomentumAlgebra.clebsch_gordan_condon_shortley","page":"Common routines","title":"AngularMomentumAlgebra.clebsch_gordan_condon_shortley","text":"clebsch_gordan_condon_shortley(j₁, m₁, j₂, m₂, j₃, m₃=m₁+m₂)\n\nCalculate the vector coupling coefficient ⟨j₁ m₁, j₂ m₂|j₃ m₃⟩ according to the Condon–Shortley phase convention and using the definition of Eq. (8.1.12) in Varshalovich (1988).\n\n\n\n\n\n","category":"function"},{"location":"common/#AngularMomentumAlgebra.@δ","page":"Common routines","title":"AngularMomentumAlgebra.@δ","text":"@δ (a,b)[, (c,d) ...]\n\nKronecker delta_abdelta_cd that tests each pair of values for equality and quick-returns 0 at the first inequality.\n\n\n\n\n\n","category":"macro"},{"location":"common/#","page":"Common routines","title":"Common routines","text":"CurrentModule = nothing\nDocTestSetup = nothing","category":"page"},{"location":"spherical_tensors/#tensors_spherical_tensors-1","page":"Spherical Tensors","title":"Spherical tensors","text":"","category":"section"},{"location":"spherical_tensors/#","page":"Spherical Tensors","title":"Spherical Tensors","text":"DocTestSetup = quote\n    using AngularMomentumAlgebra\n    using AtomicLevels\n    using LinearAlgebra\nend","category":"page"},{"location":"spherical_tensors/#","page":"Spherical Tensors","title":"Spherical Tensors","text":"The spherical tensors are related to the spherical harmonics as","category":"page"},{"location":"spherical_tensors/#","page":"Spherical Tensors","title":"Spherical Tensors","text":"tensorC^(k)_q defd\nsqrtfrac4pi2k+1\nY^k_q\ntagV517","category":"page"},{"location":"spherical_tensors/#","page":"Spherical Tensors","title":"Spherical Tensors","text":"SphericalTensor\nsystem(::SphericalTensor)","category":"page"},{"location":"spherical_tensors/#AngularMomentumAlgebra.SphericalTensor","page":"Spherical Tensors","title":"AngularMomentumAlgebra.SphericalTensor","text":"SphericalTensor(k)\n\nConstruct a spherical tensor of rank k.\n\n\n\n\n\n","category":"type"},{"location":"spherical_tensors/#AngularMomentumAlgebra.system-Tuple{SphericalTensor}","page":"Spherical Tensors","title":"AngularMomentumAlgebra.system","text":"system(::SphericalTensor)\n\nA spherical tensor only acts on the coordinates theta and phi.\n\n\n\n\n\n","category":"method"},{"location":"spherical_tensors/#","page":"Spherical Tensors","title":"Spherical Tensors","text":"The reduced matrix element of the spherical tensor is given by","category":"page"},{"location":"spherical_tensors/#","page":"Spherical Tensors","title":"Spherical Tensors","text":"beginaligned\nredmatrixelelltensorC^(k)ell\n=\nangrootell\nC_ell 0k0^ell0 =\n(-)^ell-k\nangrootellell\nwignerthreejellkell000\nendaligned\ntagV132107","category":"page"},{"location":"spherical_tensors/#","page":"Spherical Tensors","title":"Spherical Tensors","text":"For the reduced matrix element of the same spherical tensor in the ell s j basis, we must use the uncoupling formula together with the above formula in the uncoupled basis:","category":"page"},{"location":"spherical_tensors/#","page":"Spherical Tensors","title":"Spherical Tensors","text":"beginaligned\nredmatrixelell s jtensorC^(k)ell s j\n=\ndelta_ss(-)^j+ell+s+k\nangrootjj\nwignersixjellsjjkell\nredmatrixelelltensorC^(k)ell\n=\n(-)^ell+ell+s+j\nangrootellelljj\nwignersixjellsjjkell\nwignerthreejellkell000\nendaligned\ntagV1314025","category":"page"},{"location":"spherical_tensors/#","page":"Spherical Tensors","title":"Spherical Tensors","text":"rme(ℓ′::Real,𝐂̂ᵏ::SphericalTensor,ℓ::Real)\nAngularMomentumAlgebra.ranks","category":"page"},{"location":"spherical_tensors/#AngularMomentumAlgebra.rme-Tuple{Real,SphericalTensor,Real}","page":"Spherical Tensors","title":"AngularMomentumAlgebra.rme","text":"rme(ℓ′,𝐂̂ᵏ,ℓ)\n\nCalculate the reduced matrix element ⟨ℓ′||𝐂̂⁽ᵏ⁾||ℓ⟩ of the spherical tensor of rank k. Condon–Shortley phase convention and using the definition of Eq. (13.2.107) in Varshalovich (1988).\n\n\n\n\n\n","category":"method"},{"location":"spherical_tensors/#AngularMomentumAlgebra.ranks","page":"Spherical Tensors","title":"AngularMomentumAlgebra.ranks","text":"ranks(a, ::Type{SphericalTensor}, b)\n\nReturn which tensor ranks for spherical tensors that fulfill the triangle condition between spin-orbitals a and b.\n\n\n\n\n\n","category":"function"},{"location":"spherical_tensors/#Dipole-operator-1","page":"Spherical Tensors","title":"Dipole operator","text":"","category":"section"},{"location":"spherical_tensors/#","page":"Spherical Tensors","title":"Spherical Tensors","text":"The dipole operator is a rank-1 Cartesian tensor that may be expressed using the rank-1 spherical tensor:","category":"page"},{"location":"spherical_tensors/#","page":"Spherical Tensors","title":"Spherical Tensors","text":"hatvecr equiv\nbeginbmatrixhatxhatyhatzendbmatrix\nequiv\nbeginbmatrix\nfrac1sqrt2-tensorC^(1)_1 + tensorC^(1)_-1\nfracimsqrt2tensorC^(1)_1 + tensorC^(1)_-1\ntensorC^(1)_0\nendbmatrix","category":"page"},{"location":"spherical_tensors/#","page":"Spherical Tensors","title":"Spherical Tensors","text":"This submodule exists only as a shortcut to Cartesian tensor components.","category":"page"},{"location":"spherical_tensors/#","page":"Spherical Tensors","title":"Spherical Tensors","text":"CurrentModule = AngularMomentumAlgebra","category":"page"},{"location":"spherical_tensors/#","page":"Spherical Tensors","title":"Spherical Tensors","text":"Dipoles.𝐫̂","category":"page"},{"location":"spherical_tensors/#AngularMomentumAlgebra.Dipoles.𝐫̂","page":"Spherical Tensors","title":"AngularMomentumAlgebra.Dipoles.𝐫̂","text":"𝐫̂\n\nThe angular part of the dipole operator; the elements correspond to [x,y,z], i.e. the Cartesian tensor components. Can be entered as \\bfr\\hat.\n\nExamples\n\njulia> using AngularMomentumAlgebra.Dipoles\n\njulia> z = 𝐫̂[3]\n𝐂̂⁽¹⁾₀\n\njulia> dot(SpinOrbital(o\"1s\", 0, half(1)), z, SpinOrbital(o\"2p\", 0, half(1)))\n0.5773502691896256\n\n\n\n\n\n","category":"constant"},{"location":"spherical_tensors/#","page":"Spherical Tensors","title":"Spherical Tensors","text":"CurrentModule = nothing\nDocTestSetup = nothing","category":"page"},{"location":"definitions/#Definitions-1","page":"Definitions","title":"Definitions","text":"","category":"section"},{"location":"definitions/#","page":"Definitions","title":"Definitions","text":"CurrentModule = AngularMomentumAlgebra","category":"page"},{"location":"definitions/#","page":"Definitions","title":"Definitions","text":"This page defines much of the general notation and conventions used in the code. Where possible, we are consistent with Varshalovich (1988).","category":"page"},{"location":"definitions/#Shorthands-1","page":"Definitions","title":"Shorthands","text":"","category":"section"},{"location":"definitions/#","page":"Definitions","title":"Definitions","text":"The abbreviation (-)^kdefd(-1)^k is used for the roots of negative unity (see also powneg1).","category":"page"},{"location":"definitions/#","page":"Definitions","title":"Definitions","text":"A commonly occurring factor in angular momentum algebra is","category":"page"},{"location":"definitions/#","page":"Definitions","title":"Definitions","text":"angrootj_1j_2j_n\ndefd(2j_1+1)(2j_2+1)(2j_n+1)^12\ntagV1313½","category":"page"},{"location":"definitions/#","page":"Definitions","title":"Definitions","text":"It can be calculated with the unexported AngularMomentumAlgebra.∏ function.","category":"page"},{"location":"definitions/#","page":"Definitions","title":"Definitions","text":"Indices appearing in pairs on only one side of an equation are implicitly summed over.","category":"page"},{"location":"definitions/#Spherical-harmonics-1","page":"Definitions","title":"Spherical harmonics","text":"","category":"section"},{"location":"definitions/#","page":"Definitions","title":"Definitions","text":"We assume the following definition of the spherical harmonics","category":"page"},{"location":"definitions/#","page":"Definitions","title":"Definitions","text":"Y_m^ell(thetavarphi) = sqrtfrac2ell+14pifrac(ell-m)(ell+m) P_ell^m(costheta) mathrme^im m varphi\ntagV521","category":"page"},{"location":"definitions/#","page":"Definitions","title":"Definitions","text":"where theta and varphi are the usual spherical coordinates and P_ell^m(z) are the associated Legendre polynomials. The Condon-Shortley phase (-)^m is included in the definition of the Legendre polynomials, consistent with Varshalovich (1988).","category":"page"},{"location":"definitions/#","page":"Definitions","title":"Definitions","text":"An explicit expression for the Legendre polynomials is given by the Rodrigues formula:","category":"page"},{"location":"definitions/#","page":"Definitions","title":"Definitions","text":"P_ell^m(x) = frac(-)^m2^ell ell  (1 - x^2)^m2 fracmathrmd^ell+mmathrmdx^ell+m (x^2 - 1)^ell","category":"page"},{"location":"definitions/#","page":"Definitions","title":"Definitions","text":"Properties. The complex conjugate of a spherical harmonic can be expressed in terms of spherical harmonics:","category":"page"},{"location":"definitions/#","page":"Definitions","title":"Definitions","text":"barY^ell_m(thetavarphi) = (-)^m Y^ell_-m(thetavarphi)","category":"page"},{"location":"definitions/#","page":"Definitions","title":"Definitions","text":"The spherical harmonics are normalized","category":"page"},{"location":"definitions/#","page":"Definitions","title":"Definitions","text":"int_0^2pi int_0^pi\nbarY^ell_1_m_1(thetavarphi)\nY^ell_2_m_2(thetavarphi)\nsintheta difftheta diffvarphi\n= delta_ell_1 ell_2 delta_m_1 m_2\ntagV516","category":"page"},{"location":"definitions/#","page":"Definitions","title":"Definitions","text":"and the integral of three spherical harmonics is given by","category":"page"},{"location":"definitions/#","page":"Definitions","title":"Definitions","text":"int_0^2pi int_0^pi\nY^ell_1_m_1(thetavarphi)\nY^ell_2_m_2(thetavarphi)\nY^ell_3_m_3(thetavarphi)\nsintheta difftheta diffvarphi\n= frac1sqrt4pi angrootell_1ell_2ell_3\nbeginpmatrix\nell_1  ell_2  ell_3 \n0       0       0\nendpmatrix\nbeginpmatrix\nell_1  ell_2  ell_3 \nm_1     m_2     m_3\nendpmatrix\ntagV595","category":"page"},{"location":"definitions/#","page":"Definitions","title":"Definitions","text":"note: Differences from ISO 80000-2:2009\nThe ISO 80000-2:2009 standard standardizes some mathematical notations and conventions for definitions of some special functions.Index placement convention Unlike the ISO standard, we put the ell index on top and m on the bottom, to be consistent with the way the k and q indices are normally written for tensor operators.Spherical harmonics with negative m. The Condon-Shortley phase in the Legendre polynomials is consistent with the ISO standard. However, the definition of spherical harmonics differs slightly. Namely, the standard defines the spherical harmonics as followsY_m^ell(thetavarphi) = sqrtfrac2ell+14pifrac(ell-m)(ell+m) P_ell^m(costheta) mathrme^i m varphi\ntagISO1917which leads to the following relationship for the complex conjugate of Y_m^ellbarY_m^ell(thetavarphi) = Y_-m^ell(thetavarphi)We opt to follow the (arguably, more common) non-ISO definition to stay consistent with the primary reference of Varshalovich (1988).","category":"page"},{"location":"definitions/#Clebsch–Gordan-coefficients-1","page":"Definitions","title":"Clebsch–Gordan coefficients","text":"","category":"section"},{"location":"definitions/#","page":"Definitions","title":"Definitions","text":"The Clebsch–Gordan coefficients are related to the 3j symbols as","category":"page"},{"location":"definitions/#","page":"Definitions","title":"Definitions","text":"C_j_1m_1j_2m_2^j_3m_3 equiv\nbraketj_1m_1j_2m_2j_3m_3 =\n(-)^j_1-j_2+m_3angrootj_3\nbeginpmatrix\nj_1j_2j_3\nm_1m_2-m_3\nendpmatrix\ntagV8112","category":"page"},{"location":"definitions/#","page":"Definitions","title":"Definitions","text":"They can be calculated with the clebsch_gordan_condon_shortley function.","category":"page"},{"location":"definitions/#Wigner–Eckart-theorem-1","page":"Definitions","title":"Wigner–Eckart theorem","text":"","category":"section"},{"location":"definitions/#","page":"Definitions","title":"Definitions","text":"For the Wigner–Eckart theorem, which defines the reduced matrix elements (RMEs) redmatrixeln jtensorT^(k)n j of a tensor operator of rank k, the convention is the following","category":"page"},{"location":"definitions/#","page":"Definitions","title":"Definitions","text":"beginalign\nmatrixeln j mtensorT^(k)_qn j m\ndefd\n(-)^2k fracbraketjmkqj mangrootj\nredmatrixeln jtensorT^(k)n j nonumber \n=\n(-)^j-m\nbeginpmatrix\n j  k  j \n-m  q  m\nendpmatrix\nredmatrixeln jtensorT^(k)n j\ntagV1312\nendalign","category":"page"},{"location":"definitions/#","page":"Definitions","title":"Definitions","text":"The second form can be derived by using the relationship between the Clebsch–Gordan coefficients and the Wigner 3j symbols, and the permutation symmetries of the 3j symbol. The n and n labels represent all non angular momentum quantum numbers.","category":"page"},{"location":"definitions/#","page":"Definitions","title":"Definitions","text":"note: Other conventions for RMEs\nA simpler convention used by some books, that also generalizes to other symmetry groups, ismatrixeln j mtensorT^(k)_qn j m =\nbraketj_1 m_1 j_2 m_2j_3 m_3\nredmatrixeln jtensorT^(k)n jHowever, again to stay consistent with Varshalovich (1988), we shall not use it. But it must be noted that, as the Wigner–Eckart theorem functions as a definition for the reduced matrix elements, this choice will change the values of the RMEs.","category":"page"},{"location":"definitions/#","page":"Definitions","title":"Definitions","text":"CurrentModule = nothing","category":"page"},{"location":"energy_expressions/#Energy-expressions-1","page":"Energy expressions","title":"Energy expressions","text":"","category":"section"},{"location":"energy_expressions/#","page":"Energy expressions","title":"Energy expressions","text":"DocTestSetup = quote\n    using AngularMomentumAlgebra\n    using AtomicLevels\nend","category":"page"},{"location":"energy_expressions/#","page":"Energy expressions","title":"Energy expressions","text":"AngularMomentumAlgebra.integrate_spinor\nMatrix","category":"page"},{"location":"energy_expressions/#AngularMomentumAlgebra.integrate_spinor","page":"Energy expressions","title":"AngularMomentumAlgebra.integrate_spinor","text":"integrate_spinor(me)\n\nPerform the spin-angular integration of the matrix element me, leaving only a radial integral multiplied by a spin-angular coefficient. The spin-angular integral is dependent on the specific combination of spin-orbitals and the operator (expressed as a tensor); the default implementation is to leave me as-is, corresponding to a spin-angular integral of unity.\n\n\n\n\n\nintegrate_spinor(me::OrbitalMatrixElement{2,<:Any,<:CoulombInteraction,<:Any})\n\nPerform the spin-angular integration of the two-electron matrix element me, by first multipole-expanding the Coulomb interaction and then integrating all the resulting terms over the spin-angular coordinates (see multipole_expand).\n\n\n\n\n\nintegrate_spinor(integral::NBodyTermFactor)\n\nDummy method that returns integral unchanged, used for all NBodyTermFactors that are not to be multipole-expanded.\n\n\n\n\n\n","category":"function"},{"location":"energy_expressions/#Base.Matrix","page":"Energy expressions","title":"Base.Matrix","text":"Matrix(a::Vector{<:Configuration{<:SpinOrbital}},\n       op::QuantumOperator,\n       b::Vector{<:Configuration{<:SpinOrbital}}[, overlaps])\n\nGenerate the energy-expression associated with the quantum operator op, in the basis of the spin-configurations a and b, with an optional set of orbital overlaps, specifying any desired non-orthogonalities. The energy expression is generated in a basis-agnostic way by EnergyExpressions.jl and each term is then integrated over the spin-angular coordinates using integrate_spinor.\n\n\n\n\n\nMatrix(op::QuantumOperator,\n       spin_cfgs::Vector{<:Configuration{<:SpinOrbital}}[, overlaps])\n\nGenerate the energy-expression associated with the quantum operator op, in the basis of the spin-configurations spin_cfgs, with an optional set of orbital overlaps, specifying any desired non-orthogonalities. The energy expression is generated in a basis-agnostic way by EnergyExpressions.jl and each term is then integrated over the spin-angular coordinates using integrate_spinor.\n\n\n\n\n\n","category":"type"},{"location":"energy_expressions/#","page":"Energy expressions","title":"Energy expressions","text":" DocTestSetup = nothing","category":"page"},{"location":"multipole_expansions/#Multipole-expansions-1","page":"Multipole expansions","title":"Multipole expansions","text":"","category":"section"},{"location":"multipole_expansions/#","page":"Multipole expansions","title":"Multipole expansions","text":"CurrentModule = AngularMomentumAlgebra\nDocTestSetup = quote\n    using AngularMomentumAlgebra\n    using AtomicLevels\nend","category":"page"},{"location":"multipole_expansions/#","page":"Multipole expansions","title":"Multipole expansions","text":"multipole_expand_scalar_product\nmultipole_expand","category":"page"},{"location":"multipole_expansions/#AngularMomentumAlgebra.multipole_expand_scalar_product","page":"Multipole expansions","title":"AngularMomentumAlgebra.multipole_expand_scalar_product","text":"multipole_expand_scalar_product(a, b, P, Q, c, d)\n\nMultipole-expand the matrix element ⟨ab|P⋅Q|cd⟩, where the tensor P acts on orbitals a & c, and the tensor Q acts on orbitals b & d. The definition is taken from Eq. (13.1.26) of Varshalovich (1988).\n\n\n\n\n\n","category":"function"},{"location":"multipole_expansions/#AngularMomentumAlgebra.multipole_expand","page":"Multipole expansions","title":"AngularMomentumAlgebra.multipole_expand","text":"multipole_expand(integral::OrbitalMatrixElement{2,A,<:CoulombInteraction,B})\n\nMultipole-expand the two-body integral resulting from the Coulomb repulsion between two electrons.\n\n\n\n\n\n","category":"function"},{"location":"multipole_expansions/#","page":"Multipole expansions","title":"Multipole expansions","text":" DocTestSetup = nothing","category":"page"},{"location":"gradients/#gradients-1","page":"Gradients","title":"Gradients","text":"","category":"section"},{"location":"gradients/#","page":"Gradients","title":"Gradients","text":"The gradient is a rank-1 tensor, the reduced matrix element of which is given by","category":"page"},{"location":"gradients/#","page":"Gradients","title":"Gradients","text":"beginequation\ntagV13221\nredmatrixelnelltensornabla^(1)nell =\nsqrtell+1\nA_nellnelldelta_ellell+1 +\nsqrtell\nB_nellnelldelta_ellell-1\nendequation","category":"page"},{"location":"gradients/#","page":"Gradients","title":"Gradients","text":"where","category":"page"},{"location":"gradients/#","page":"Gradients","title":"Gradients","text":"beginequation\ntagV13222\nbeginaligned\nA_nellnell defd\nint_0^inftydiffrr^2\nconjPsi_nell(r)\nleft(partial_r-fracellrright)\nPsi_nell(r)\nB_nellnell defd\nint_0^inftydiffrr^2\nconjPsi_nell(r)\nleft(partial_r+fracell+1rright)\nPsi_nell(r)\nendaligned\nendequation","category":"page"},{"location":"gradients/#Example-1","page":"Gradients","title":"Example","text":"","category":"section"},{"location":"gradients/#","page":"Gradients","title":"Gradients","text":"julia> using AngularMomentumAlgebra, AtomicLevels\n\njulia> orbitals = sos\"k[s-d]\"\n18-element Array{SpinOrbital{Orbital{Symbol},Tuple{Int64,HalfIntegers.Half{Int64}}},1}:\n ks₀α\n ks₀β\n kp₋₁α\n kp₋₁β\n kp₀α\n kp₀β\n kp₁α\n kp₁β\n kd₋₂α\n kd₋₂β\n kd₋₁α\n kd₋₁β\n kd₀α\n kd₀β\n kd₁α\n kd₁β\n kd₂α\n kd₂β\n\njulia> a,b,c = orbitals[[3,9,13]]\n3-element Array{SpinOrbital{Orbital{Symbol},Tuple{Int64,HalfIntegers.Half{Int64}}},1}:\n kp₋₁α\n kd₋₂α\n kd₀α\n\njulia> ∂x = cartesian_tensor_component(Gradient(), :x)\n- 0.707107 𝛁̂⁽¹⁾₁ + 0.707107 𝛁̂⁽¹⁾₋₁\n\njulia> dot(a, ∂x, b)\n0.447214(∂ᵣ + 3/r)\n\njulia> dot(b, ∂x, a)\n0.447214(∂ᵣ - 1/r)\n\njulia> dot(a, ∂x, c)\n- 0.182574(∂ᵣ + 3/r)\n\njulia> dot(c, ∂x, a)\n- 0.182574(∂ᵣ - 1/r)","category":"page"},{"location":"gradients/#Reference-1","page":"Gradients","title":"Reference","text":"","category":"section"},{"location":"gradients/#","page":"Gradients","title":"Gradients","text":"Gradient\nsystem(::Gradient)\nAngularMomentumAlgebra.RadialGradientMatrixElement","category":"page"},{"location":"gradients/#AngularMomentumAlgebra.Gradient","page":"Gradients","title":"AngularMomentumAlgebra.Gradient","text":"Gradient()\n\nConstruct a gradient tensor.\n\n\n\n\n\n","category":"type"},{"location":"gradients/#AngularMomentumAlgebra.system-Tuple{Gradient}","page":"Gradients","title":"AngularMomentumAlgebra.system","text":"system(::Gradient)\n\nThe gradient only acts on the coordinates r, theta, and phi.\n\n\n\n\n\n","category":"method"},{"location":"gradients/#AngularMomentumAlgebra.RadialGradientMatrixElement","page":"Gradients","title":"AngularMomentumAlgebra.RadialGradientMatrixElement","text":"RadialGradientMatrixElement(k)\n\nThis represents the matrix element of the radial component of the gradient operator:\n\nbeginequation\ntagV13224\nint_0^inftydiffrr^2\nconjPsi_nell(r)\nleft(partial_r+frackrright)\nPsi_nell(r)\nendequation\n\n\n\n\n\n","category":"type"},{"location":"tensors/#Tensors-1","page":"General tensors","title":"Tensors","text":"","category":"section"},{"location":"tensors/#","page":"General tensors","title":"General tensors","text":"DocTestSetup = quote\n    using AngularMomentumAlgebra\n    using AtomicLevels\n    using LinearAlgebra\nend","category":"page"},{"location":"tensors/#","page":"General tensors","title":"General tensors","text":"Tensor\nTensorComponent\nAngularMomentumAlgebra.LinearCombinationTensor\nsystem(::Tensor)\nAngularMomentumAlgebra.complementary_space_factor\nAngularMomentumAlgebra.rme_j′j","category":"page"},{"location":"tensors/#AngularMomentumAlgebra.Tensor","page":"General tensors","title":"AngularMomentumAlgebra.Tensor","text":"Tensor{k,label}\n\nAbstract base for any tensor of rank k.\n\n\n\n\n\n","category":"type"},{"location":"tensors/#AngularMomentumAlgebra.TensorComponent","page":"General tensors","title":"AngularMomentumAlgebra.TensorComponent","text":"TensorComponent(tensor, q)\n\nRepresents the qth component of a tensor; abs(q) ≤ rank(tensor).\n\n\n\n\n\n","category":"type"},{"location":"tensors/#AngularMomentumAlgebra.LinearCombinationTensor","page":"General tensors","title":"AngularMomentumAlgebra.LinearCombinationTensor","text":"LinearCombinationTensor\n\nRepresents a linear combination of tensor components.\n\n\n\n\n\n","category":"type"},{"location":"tensors/#AngularMomentumAlgebra.system-Tuple{Tensor}","page":"General tensors","title":"AngularMomentumAlgebra.system","text":"system(::Tensor)\n\nA general tensor acts on the full system, i.e. all coordinates.\n\n\n\n\n\n","category":"method"},{"location":"tensors/#AngularMomentumAlgebra.complementary_space_factor","page":"General tensors","title":"AngularMomentumAlgebra.complementary_space_factor","text":"complementary_space_factor(::SpatialSubSystems, k,\n                           o′::SpinOrbital{<:Orbital},\n                           o::SpinOrbital{<:Orbital})\n\nTensors acting on the spatial coordinates only, are diagonal in spin space:\n\nbeginequation\ntagV1323\nmatrixelnellm_ellsm_stensorM^(k)_q(rthetaphi)nell m_ellsm_s =\ndelta_ssdeltam_sm_s\nmatrixelnellm_elltensorM^(k)_q(rthetaphi)nell m_ell\nendequation\n\n\n\n\n\ncomplementary_space_factor(::SpinSubSystem, k,\n                           o′::SpinOrbital{<:Orbital},\n                           o::SpinOrbital{<:Orbital})\n\nTensors acting on the spin coordinates only, are diagonal in the spatial coordinates:\n\nbeginequation\ntagV1324\nmatrixelnellm_ellsm_stensorN^(k)_q(xi)nell m_ellsm_s =\ndelta_ellelldeltam_ell m_ell\nmatrixelsm_stensorN^(k)_q(xi)sm_s\nendequation\n\n\n\n\n\ncomplementary_space_factor(::SpatialSubSystems, k,\n                           o′::SpinOrbital{<:RelativisticOrbital},\n                           o::SpinOrbital{<:RelativisticOrbital})\n\nTensors acting on the spatial coordinates only, are diagonal in spin space; in the coupled basis, the following uncoupling formula must be employed:\n\nbeginequation\ntagV1325\nredmatrixelnellsJtensorM^(k)nell s J =\ndelta_ss\n(-)^J+ell+s+k\nangrootJJ\nwignersixjellsJJkell\nredmatrixelnelltensorM^(k)nell\nendequation\n\n\n\n\n\ncomplementary_space_factor(::SpinSubSystem, k,\n                           o′::SpinOrbital{<:RelativisticOrbital},\n                           o::SpinOrbital{<:RelativisticOrbital})\n\nTensors acting on the spin coordinates only, are diagonal in the spatial coordinates; in the coupled basis, the following uncoupling formula must be employed:\n\nbeginequation\ntagV1326\nredmatrixelnellsJtensorN^(k)nell s J =\ndelta_ellell\n(-)^J+ell+s+k\nangrootJJ\nwignersixjsellJJks\nredmatrixelnstensorN^(k)ns\nendequation\n\n\n\n\n\n","category":"function"},{"location":"tensors/#AngularMomentumAlgebra.rme_j′j","page":"General tensors","title":"AngularMomentumAlgebra.rme_j′j","text":"rme_j′j(o′::SpinOrbital, T::Tensor, o::SpinOrbital)\n\nReturn the reduced matrix element ⟨o′||T||o⟩ and the two angular momenta pertaining to the tensor T, along with their projections.\n\n\n\n\n\n","category":"function"},{"location":"tensors/#Cartesian-tensor-components-1","page":"General tensors","title":"Cartesian tensor components","text":"","category":"section"},{"location":"tensors/#","page":"General tensors","title":"General tensors","text":"The transformation of the tensor components of a rank-1 tensor from the Cartesian basis to the \"natural\" basis is given by:","category":"page"},{"location":"tensors/#","page":"General tensors","title":"General tensors","text":"beginequation\nM(+10-1 leftarrow x y z)=\nbeginbmatrix\n-frac1sqrt2fracimsqrt2cdot\ncdotcdot1\nfrac1sqrt2fracimsqrt2cdot\nendbmatrix\nendequation","category":"page"},{"location":"tensors/#","page":"General tensors","title":"General tensors","text":"cartesian_tensor_component","category":"page"},{"location":"tensors/#AngularMomentumAlgebra.cartesian_tensor_component","page":"General tensors","title":"AngularMomentumAlgebra.cartesian_tensor_component","text":"cartesian_tensor_component(t::Tensor{1}, c)\n\nThis returns the Cartesian tensor component c (valid choices are :x, :y, or :z) of the rank-1 tensor t, as a linear combination of its \"natural\" TensorComponents 1, 0, and -1. The transform matrix is M(+1, 0, -1 ← x, y, z) given in Table 1.2 on p. 14 of Varshalovich (1988).\n\nExamples\n\njulia> cartesian_tensor_component(Gradient(), :x)\n- 0.707107 𝛁̂⁽¹⁾₁ + 0.707107 𝛁̂⁽¹⁾₋₁\n\n\n\n\n\n","category":"function"},{"location":"tensors/#Product-tensors-1","page":"General tensors","title":"Product tensors","text":"","category":"section"},{"location":"tensors/#","page":"General tensors","title":"General tensors","text":"TensorProduct","category":"page"},{"location":"tensors/#AngularMomentumAlgebra.TensorProduct","page":"General tensors","title":"AngularMomentumAlgebra.TensorProduct","text":"TensorProduct{K}(T, U)\n\nA tensor of rank K formed from the product of the tensors T and U, according to\n\nbeginequation\ntagV3120\ntensorX^(K)_Q equiv\ntensorT^(k_1)tensorU^(k_2)^(K)_Q defd\ntensorT^(k_1)_q_1\ntensorU^(k_2)_q_2\nC_k_1q_1k_2q_2^KQ\nendequation\n\n\n\n\n\n","category":"type"},{"location":"tensors/#Scalar-product-1","page":"General tensors","title":"Scalar product","text":"","category":"section"},{"location":"tensors/#","page":"General tensors","title":"General tensors","text":"The matrix element of scalar product of two tensors acting on different coordinates is given by","category":"page"},{"location":"tensors/#","page":"General tensors","title":"General tensors","text":"beginequation\nbeginaligned\nmatrixeln_aj_am_an_bj_bm_btensorP^(k)(1)cdottensorQ^(k)(2)n_cj_cm_cn_dj_dm_d\n=\nfrac1angrootj_aj_b\nsum_alpha(-)^-alpha\nC_j_cm_ckalpha^j_am_a\nC_j_dm_dk-alpha^j_bm_b\ntimes\nredmatrixeln_aj_atensorP^(k)(1)n_cj_c\nredmatrixeln_bj_btensorQ^(k)(2)n_dj_d\nendaligned\ntagV13126\nendequation","category":"page"},{"location":"tensors/#","page":"General tensors","title":"General tensors","text":"Since the Clebsch–Gordan coefficients can be rewritten using 3j symbols and the 3j symbols vanish unless m_c + alpha - m_3 = m_d - alpha - m_b = 0, we have","category":"page"},{"location":"tensors/#","page":"General tensors","title":"General tensors","text":"beginequation\nalpha = m_a - m_c = m_d-m_b\nimplies\n-alpha + m_a + m_b = m_b + m_c\nendequation","category":"page"},{"location":"tensors/#","page":"General tensors","title":"General tensors","text":"TensorScalarProduct\ndot(::Tensor, ::Tensor)\nAngularMomentumAlgebra.integrate_spinors((a,b), X::TensorScalarProduct, (c,d))","category":"page"},{"location":"tensors/#AngularMomentumAlgebra.TensorScalarProduct","page":"General tensors","title":"AngularMomentumAlgebra.TensorScalarProduct","text":"TensorScalarProduct(T, U)\n\nA tensor of rank 0 formed from the product of the tensors T and U (which have to have the same rank), according to\n\nbeginequation\ntagV313035\n(tensorT^(k) cdot\ntensorU^(k)) defd\n(-)^kangrootk\ntensorT^(k)\ntensorU^(k)^(0)_0 equiv\n(-)^q\ntensorT^(k)_q\ntensorU^(k)_-q\nendequation\n\n\n\n\n\n","category":"type"},{"location":"tensors/#LinearAlgebra.dot-Tuple{Tensor,Tensor}","page":"General tensors","title":"LinearAlgebra.dot","text":"dot(T::Tensor, U::Tensor)\n\nForm the scalar product of the two tensors T and U, which need to have the same rank.\n\nExamples\n\njulia> SphericalTensor(4)⋅SphericalTensor(4)\n(𝐂̂⁽⁴⁾⋅𝐂̂⁽⁴⁾)\n\n\n\n\n\n","category":"method"},{"location":"tensors/#AngularMomentumAlgebra.integrate_spinors-Tuple{Any,TensorScalarProduct,Any}","page":"General tensors","title":"AngularMomentumAlgebra.integrate_spinors","text":"integrate_spinors((a,b), X, (c,d))\n\nPerform the spin-angular integration of the scalar-product tensor X≡(T⁽ᵏ⁾⋅U⁽ᵏ⁾), where T acts on the coordinate of orbitals a & c and similarly, U acts on the coordinate of orbitals b & d, according to Eq. (13.1.26) of Varshalovich (1988).\n\n\n\n\n\n","category":"method"},{"location":"tensors/#The-Wigner–Eckart-theorem-1","page":"General tensors","title":"The Wigner–Eckart theorem","text":"","category":"section"},{"location":"tensors/#","page":"General tensors","title":"General tensors","text":"The Wigner–Eckart theorem states that the matrix element of a tensor component tensorT^(k)_q can be evaluated as","category":"page"},{"location":"tensors/#","page":"General tensors","title":"General tensors","text":"beginequation\nmatrixelnjmtensorT^(k)_qnjm=\n(-)^j-m\nbeginpmatrix\njkj\n-mqm\nendpmatrix\nredmatrixelnjtensorT^(k)nj\ntagV1312\nendequation","category":"page"},{"location":"tensors/#","page":"General tensors","title":"General tensors","text":"where the reduced matrix element redmatrixelnjtensorT^(k)nj does not depend on mm.","category":"page"},{"location":"tensors/#","page":"General tensors","title":"General tensors","text":"wigner_eckart\ndot(o′::SpinOrbital, T::Union{TensorComponent,AngularMomentumAlgebra.LinearCombinationTensor}, o::SpinOrbital)","category":"page"},{"location":"tensors/#AngularMomentumAlgebra.wigner_eckart","page":"General tensors","title":"AngularMomentumAlgebra.wigner_eckart","text":"wigner_eckart(o′::SpinOrbital, Tᵏq::TensorComponent, o::SpinOrbital)\n\nCalculate the matrix element ⟨o′|Tᵏq|o⟩ via Wigner–Eckart's theorem, automatically applying the appropriate uncoupling formulas (V13.2.5,6) of Varshalovich (1988) if o′ and o are coupled spin-orbitals and Tᵏ acts on one part of the system only.\n\n\n\n\n\n","category":"function"},{"location":"tensors/#LinearAlgebra.dot-Tuple{SpinOrbital,Union{LinearCombination{#s23,N} where #s23<:(TensorComponent{#s22} where #s22<:T) where N<:Number where T<:Tensor, TensorComponent},SpinOrbital}","page":"General tensors","title":"LinearAlgebra.dot","text":"dot(o′, T, o)\n\nCalculates the matrix element ⟨o′|T|o⟩ using wigner_eckart.\n\n\n\n\n\n","category":"method"},{"location":"tensors/#","page":"General tensors","title":"General tensors","text":"CurrentModule = nothing\nDocTestSetup = nothing","category":"page"},{"location":"#AngularMomentumAlgebra.jl-1","page":"Home","title":"AngularMomentumAlgebra.jl","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"Documentation for AngularMomentumAlgebra.jl","category":"page"},{"location":"#","page":"Home","title":"Home","text":"Equation labelled (Vx.y.z) references equation (z) from section x.y of","category":"page"},{"location":"#","page":"Home","title":"Home","text":"Varshalovich, D. A. (1988). Quantum Theory of Angular Momentum: Irreducible Tensors, Spherical Harmonics, Vector Coupling Coefficients, 3nj Symbols. Singapore Teaneck, NJ, USA: World Scientific Pub.","category":"page"},{"location":"#","page":"Home","title":"Home","text":"The Condon–Shortley convention is employed throughout (if you spot a mistake, please tell me!), and formulas are taken from Varshalovich (1988) only, to ensure consistency.","category":"page"}]
}
